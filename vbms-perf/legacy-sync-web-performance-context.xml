<beans xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	   xmlns:context="http://www.springframework.org/schema/context"
	   xmlns:aop="http://www.springframework.org/schema/aop"
	   xmlns="http://www.springframework.org/schema/beans"
	   xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
                           http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd
						   http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd">

	<context:annotation-config/>

	<!-- Properties Imports -->
	<context:property-placeholder
			ignore-unresolvable="true"
			ignore-resource-not-found="true"
			location="classpath:META-INF/spring/legacy-sync-web-performance.properties,
					  classpath:vbms_p2.properties"/>

	<aop:aspectj-autoproxy proxy-target-class="false"/>

	<!-- ============================ Performance Bean Definitions ================================== -->

	<bean id="performanceMonitorScheduler"
		  class="gov.va.vba.vbms.common.framework.performance.PerformanceMonitorScheduler"/>

	<bean id="perfDataSource" class="org.springframework.jndi.JndiObjectFactoryBean">
		<property name="jndiName" value="jdbc/perfDataSource"/>
	</bean>

	<bean id="performanceJdbcDao" class="gov.va.vba.vbms.common.framework.performance.PerformanceJdbcDao">
		<property name="perfDataSource" ref="perfDataSource"/>
	</bean>

	<bean id="jdbcTemplate" class="org.springframework.jdbc.core.JdbcTemplate">
		<constructor-arg ref="perfDataSource"/>
	</bean>

	<bean id="perfMon" class="gov.va.vba.vbms.common.framework.performance.PerformanceMonitorAspect">
		<property name="methodSource" value="${vbms.sync.legacy.performance.methodSource}"/>
	</bean>

	<aop:config>
		<aop:aspect id="perfAspect" ref="perfMon">
			<aop:pointcut id="perfPointcut" expression="(execution(* gov.va.vba.vbms..*.*(..))) and
!(execution(* gov.va.vba.vbms.dal.ecm.filenet.MetaDataProperty.*(..))
|| execution(* gov.va.vba.vbms.dal.impl.businessmetrics.config.BusinessMetricComponentPostProcessor.postProcessBeforeInitialization(..))
|| execution(* gov.va.vba.vbms.dal.impl.businessmetrics.config.BusinessMetricComponentPostProcessor.postProcessAfterInitialization(..))
|| execution(* gov.va.vba.vbms.event.spring.EventGatewayComponentPostProcessor.postProcessBeforeInitialization(..))
|| execution(* gov.va.vba.vbms.event.spring.EventGatewayComponentPostProcessor.postProcessAfterInitialization(..))
|| execution(* gov.va.vba.vbms.event.spring.EventComponentPostProcessor.postProcessBeforeInitialization(..))
|| execution(* gov.va.vba.vbms.event.spring.EventComponentPostProcessor.postProcessAfterInitialization(..))
|| execution(* gov.va.vba.vbms.transform.impl.BaseTransformer.*(..))
|| execution(* gov.va.vba.vbms.transform.impl.orika.OrikaTransformer.*(..)))"/>
			<aop:around pointcut-ref="perfPointcut" method="monitorPerformance"/>
		</aop:aspect>
	</aop:config>

</beans>


